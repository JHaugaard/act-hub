services:
  pocketbase:
    build:
      context: .
      dockerfile: Dockerfile.pocketbase
    container_name: act_hub_pocketbase_local
    ports:
      - "8090:8090" # API
      - "8091:8091" # Admin UI
    volumes:
      # Mount to external drive for data persistence and inspection
      - /Volumes/dev/develop/act-hub/pocketbase-data:/pb_data
    environment:
      - POCKETBASE_SUPERUSER_EMAIL=admin@local.test
      - POCKETBASE_SUPERUSER_PASSWORD=admin123456
    command: [ "/usr/local/bin/pocketbase", "serve", "--http=0.0.0.0:8090", "--dir=/pb_data", "--migrationsDir=/pb_data/migrations" ]
    restart: unless-stopped
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:8090/api/health" ]
      interval: 10s
      timeout: 5s
      retries: 5
